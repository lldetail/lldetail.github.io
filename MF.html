<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
		<meta charset="UTF-8">
		<link rel="stylesheet" type="text/css" href="cursor/style.css">
		<script src='song.js'></script>
		<style>
			* {
			  -webkit-box-sizing: border-box;
				 -moz-box-sizing: border-box;
					  box-sizing: border-box;
			}
			html {
				font-family: "Microsoft YaHei UI Light", "Microsoft YaHei UI", sans-serif;
			}
			table {
				border-spacing:0px;
			}
			th, td {
				border:1px solid black;
			}
			.Smile {
				background-color: #FF99CC;
			}
			.Pure {
				background-color: #CCFF99;
			}
			.Cool {
				background-color: #99CCFF;
			}
		</style>
	</head>
	<body style="margin: 0px; padding: 15px">
		<script>
			song = [];
			ele = ["Smile","Pure","Cool"];
			for (i = 0; i < song_list.length; i++){
				song[parseInt(song_list[i].sound.substring(21, 24))] = song_list[i];
			};
			function calc(){
				res = "<table style='width:100%'><tr><th style='width:10%'>Rank</th><th style='width:80%'>Combination</th><th style='width:10%'>Combo</th></tr>";
				selected = document.getElementById("event").value.split(",");
				diff = document.getElementById("diff").value;
				element = [];
				element[0] = selected.slice(0, 8); //smile
				element[1] = selected.slice(8, 16); //pure
				element[2] = selected.slice(16, 24); //cool	
				sort_list = [];
				count = 0;
				for (n = 0; n <= 2; n++){
					for (i = 0; i < 6; i++){
						for (j = i+1; j < 7; j++){
							for (k = j+1; k < 8; k++){
								sort_list[count] = [];
								sort_list[count][0] = song[element[n][i]].name + " + " + song[element[n][j]].name + " + " + song[element[n][k]].name;
								sort_list[count][1] = song[element[n][i]].difficulties[diff].s_rank_combo + song[element[n][j]].difficulties[diff].s_rank_combo + song[element[n][k]].difficulties[diff].s_rank_combo;
								sort_list[count][2] = n;
								count ++;
							};
						};
					};
				};
				if (document.getElementById("num").value == 2){
					for (n = 0; n <= 2; n++){
						for (i = 0; i < 7; i++){
							for (j = i+1; j < 8; j++){
								sort_list[count] = [];
								sort_list[count][0] = song[element[n][i]].name + " + " + song[element[n][j]].name;
								sort_list[count][1] = song[element[n][i]].difficulties[diff].s_rank_combo + song[element[n][j]].difficulties[diff].s_rank_combo;
								sort_list[count][2] = n;
								count ++;
							};
						};
					};
					for (n = 0; n <= 2; n++){
						for (i = 0; i < 8; i++){
							sort_list[count] = [];
							sort_list[count][0] = song[element[n][i]].name;
							sort_list[count][1] = song[element[n][i]].difficulties[diff].s_rank_combo;
							sort_list[count][2] = n;
							count ++;
						};
					};
				};
				sort_list.sort(function(a, b) {
					return parseFloat(b[1])>parseFloat(a[1])?1:parseFloat(b[1])==parseFloat(a[1])?parseFloat(a[2])-parseFloat(b[2]):-1;
				});
				for (m = 0; m < count; m++){
					sort_list[m][3] = (m == 0?1:sort_list[m][1] == sort_list[m-1][1]?sort_list[m-1][3]:m+1);
					res = res + "<tr class='" + ele[sort_list[m][2]] + "'><td>" + sort_list[m][3] + "</td><td>" + sort_list[m][0] + "</td><td>" + sort_list[m][1] + "</td></tr>";
				};
				res = res + '</table>';
				document.getElementById("result").innerHTML=res;
			};
		</script>
		<select id="event">
		  <option value="5,13,22,52,72,74,84,103,4,35,53,55,75,85,110,130,21,30,58,64,88,89,98,137" selected>JP MF 18</option>
		</select>
		<select id="diff">
		  <option value="0">Easy</option>
		  <option value="1">Normal</option>
		  <option value="2">Hard</option>
		  <option value="3" selected>Expert</option>
		</select>
		<select id="num">
		  <option value="1">3 Song Combinations</option>
		  <option value="2" selected>All Combinations</option>
		</select>
		<button onclick="calc()">Calculate</button>
		<div id="result">
		</div>
	</body>
</html>